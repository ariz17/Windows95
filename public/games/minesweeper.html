<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Minesweeper</title>
  <style>
    body { margin: 0; padding: 0; display: flex; align-items: center; justify-content: center; height: 100vh; overflow: hidden; background:#c0c0c0; font-family: 'MS Sans Serif', sans-serif; }
    .wrap { background:#fff; border:2px solid #000; padding:10px; width: fit-content; height: fit-content; min-width: 480px; min-height: 520px; overflow: auto; }
    .top { display:flex; justify-content:space-between; margin-bottom:8px; font-weight:bold; }
    .board { display:grid; gap:2px; background:#808080; padding:2px; }
    .cell { width:28px; height:28px; display:flex; align-items:center; justify-content:center; background:#bdbdbd; border:2px outset #fff; font-weight:bold; user-select:none; cursor:pointer; }
    .cell.revealed { background:#dddddd; border:2px inset #fff; cursor:default; }
    .num1{ color:#0000ff;} .num2{color:#008000;} .num3{color:#ff0000;} .num4{color:#000080;} .num5{color:#800000;} .num6{color:#008080;} .num7{color:#000000;} .num8{color:#808080;}
    button { font-family:inherit; padding:4px 8px; }
    
    /* Mobile optimizations */
    @media (max-width: 768px) {
      body { 
        height: 100vh; 
        overflow: hidden; 
        padding: 0;
        margin: 0;
      }
      .wrap { 
        width: 100vw;
        height: calc(100vh - 60px);
        max-width: none;
        max-height: none;
        overflow: hidden;
        padding: 8px;
        border: none;
        display: flex;
        flex-direction: column;
      }
      .top { 
        font-size: 14px; 
        margin-bottom: 8px;
        flex-shrink: 0;
        justify-content: center;
        gap: 15px;
      }
      .board {
        flex: 1;
        overflow: auto;
        gap: 1px;
        padding: 2px;
        justify-content: center;
        align-content: start;
      }
      .cell { 
        width: calc((100vw - 24px) / 16);
        height: calc((100vw - 24px) / 16);
        max-width: 20px;
        max-height: 20px;
        font-size: 9px;
        border: 1px outset #fff;
        min-width: 18px;
        min-height: 18px;
      }
      .cell.revealed {
        border: 1px inset #fff;
      }
      button {
        padding: 6px 10px;
        font-size: 12px;
        border: 2px outset #c0c0c0;
        background: #c0c0c0;
      }
    }
    
    /* Portrait mobile - smaller cells for better fit */
    @media (max-width: 480px) and (orientation: portrait) {
      .cell {
        width: calc((100vw - 20px) / 16);
        height: calc((100vw - 20px) / 16);
        max-width: 18px;
        max-height: 18px;
        font-size: 8px;
        min-width: 16px;
        min-height: 16px;
      }
      .top {
        font-size: 12px;
        gap: 10px;
      }
      button {
        padding: 4px 8px;
        font-size: 11px;
      }
    }
    
    /* Landscape mobile - optimize for wider screen */
    @media (max-width: 768px) and (orientation: landscape) {
      .wrap {
        height: calc(100vh - 40px);
      }
      .cell {
        width: 18px;
        height: 18px;
        font-size: 9px;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <button id="reset">üí° New Game</button>
      <div>‚è±Ô∏è <span id="timer">0</span>s</div>
    </div>
    <div id="board" class="board"></div>
  </div>
  <script>
    const boardEl = document.getElementById('board');
    const timerEl = document.getElementById('timer');
    const resetBtn = document.getElementById('reset');

    // Config - medium 16x16, 40 mines (classic)
    const ROWS = 16, COLS = 16, MINES = 40;
    let grid, revealed, mineSet, startTime, timerId, gameOver;

    function init(){
      boardEl.style.gridTemplateColumns = `repeat(${COLS}, 28px)`;
      grid = Array.from({length:ROWS}, ()=> Array.from({length:COLS}, ()=>0));
      revealed = new Set();
      mineSet = new Set();
      gameOver = false;
      timerEl.textContent = '0';
      if (timerId) clearInterval(timerId);
      startTime = null;
      placeMines();
      calcNumbers();
      render();
    }

    function key(r,c){ return r+','+c; }

    function placeMines(){
      while(mineSet.size < MINES){
        const r = Math.floor(Math.random()*ROWS);
        const c = Math.floor(Math.random()*COLS);
        mineSet.add(key(r,c));
      }
    }

    function inBounds(r,c){ return r>=0 && r<ROWS && c>=0 && c<COLS; }

    function neighbors(r,c){
      const dirs=[-1,0,1];
      const list=[];
      for(const dr of dirs){
        for(const dc of dirs){
          if(dr===0 && dc===0) continue;
          const nr=r+dr, nc=c+dc;
          if(inBounds(nr,nc)) list.push([nr,nc]);
        }
      }
      return list;
    }

    function calcNumbers(){
      for(let r=0;r<ROWS;r++){
        for(let c=0;c<COLS;c++){
          if(mineSet.has(key(r,c))){ grid[r][c] = -1; continue; }
          grid[r][c] = neighbors(r,c).reduce((acc,[nr,nc])=> acc + (mineSet.has(key(nr,nc))?1:0), 0);
        }
      }
    }

    function render(){
      boardEl.innerHTML='';
      for(let r=0;r<ROWS;r++){
        for(let c=0;c<COLS;c++){
          const div=document.createElement('div');
          div.className='cell';
          div.dataset.r=r; div.dataset.c=c;
          const k=key(r,c);
          if(revealed.has(k)) revealCellDiv(div, r, c);
              boardEl.appendChild(div);
        }
      }
    }

    function revealCell(r,c){
      const k=key(r,c);
      if(revealed.has(k) || gameOver) return;
      revealed.add(k);
      if(grid[r][c] === -1){
        gameOver = true;
        if (timerId) clearInterval(timerId);
        revealAllMines();
        alert('Boom! Game over.');
        return;
      }
      if(grid[r][c] === 0){
        for(const [nr,nc] of neighbors(r,c)) revealCell(nr,nc);
      }
      // Win check
      if(revealed.size === ROWS*COLS - MINES){
        gameOver = true;
        if (timerId) clearInterval(timerId);
        alert('You win!');
      }
    }

    function revealAllMines(){
      for(const m of mineSet){
        const [r,c] = m.split(',').map(Number);
        const idx = r*COLS + c;
        const div = boardEl.children[idx];
        div.classList.add('revealed');
        div.textContent = 'üí£';
      }
    }

    function revealCellDiv(div, r, c){
      div.classList.add('revealed');
      const val = grid[r][c];
      if(val>0){ div.textContent = val; div.classList.add('num'+val); }
      else { div.textContent = ''; }
    }


    boardEl.addEventListener('contextmenu', e=> e.preventDefault());
    
    
    // Mouse events for desktop
    boardEl.addEventListener('click', (e)=>{
      const target = e.target.closest('.cell');
      if(!target || gameOver) return;
      
      const r = +target.dataset.r, c = +target.dataset.c;
      if(!startTime){ startTime = Date.now(); timerId = setInterval(()=>{ timerEl.textContent = Math.floor((Date.now()-startTime)/1000); }, 1000); }
      
      revealCell(r,c);
      render();
    });
    

    resetBtn.addEventListener('click', init);

    init();
  </script>
</body>
</html>
